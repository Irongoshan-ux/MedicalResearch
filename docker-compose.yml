version: '3.4'

services:
  mongodb:
    container_name: mongo
    image: mongo
    restart: always
    volumes:
      - ${WEBAPP_STORAGE_HOME}/site:/data/db
      #- ./data:/data/db
    ports:
      - "27017:27017"
      - "27018:27018"

  mssql:
    image: "mcr.microsoft.com/mssql/server"
    environment:
      SA_PASSWORD: "somepassword.01"
      ACCEPT_EULA: "Y"
    ports:
      - "3306:3306"

  medicinemanaging.api:
    image: ${DOCKER_REGISTRY-}medicinemanagingapi
    build:
      context: .
      dockerfile: MedicineManaging.API/Dockerfile
    ports:
      - "10000:80"
    depends_on:
      - mongodb

  usermanaging.api:
    image: ${DOCKER_REGISTRY-}usermanagingapi
    build:
      context: .
      dockerfile: MedicalResearch/Dockerfile
    ports:
      - "9000:80"
    depends_on:
      - mssql


networks:
  vpcbr:
    driver: bridge
    ipam:
     config:
       - subnet: 10.5.0.0/16
         gateway: 10.5.0.1